<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Калькулятор теплового потока от бетонной плиты</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #222931;
            margin: 0;
        }
        .calculator {
            background: #222931;
            max-width: 370px;
            margin: 18px auto 0 auto;
            border-radius: 16px;
            box-shadow: 0 2px 16px rgba(70, 118, 250, 0.10);
            padding: 7px 2vw 7px 2vw;
        }
        @media (max-width: 500px) {
            .calculator {
                max-width: 100vw;
                padding: 16px 7vw 18px 7vw;
            }
        }
        h2 {
            text-align: center;
            color: #98b6ff;
            font-size: 1.2rem;
            margin-bottom: 14px;
        }
        .knob-label {
            color: #bbc7d4;
            margin-bottom: 8px;
            font-size: 0.98rem;
            text-align: center;
        }
        .circle-range-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.2em;
            margin-bottom: 8px;
        }
        .circle-range-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: #2e3742;
            color: #fff;
            font-size: 1.7em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.09);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.17s;
            user-select: none;
        }
        .circle-range-btn:active {
            background: #53b4ff;
            color: #fff;
        }
        .circle-range-wrapper {
            position: relative;
            width: 138px;
            height: 138px;
        }
        .circle-range-svg {
            transform: rotate(0deg);
        }
        .circle-range-track {
            stroke: #444d57;
            stroke-width: 18;
        }
        .circle-range-fill {
            stroke: #53b4ff;
            stroke-width: 18;
            transition: stroke-dashoffset 0.25s;
        }
        .circle-range-text {
            fill: #fff;
            font-size: 2.2em;
            font-weight: bold;
            text-anchor: middle;
            dominant-baseline: middle;
        }
        .circle-range-label {
            fill: #8ea5c8;
            font-size: 1em;
            text-anchor: middle;
        }
        .circle-range-input {
            position: absolute; left: 0; top: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;
        }
        .slider-row { margin-bottom: 14px; margin-top: 0; }
        .slider-label {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 3px; font-size: 0.98rem; color: #b4bed0;
        }
        .slider-value {
            min-width: 44px; text-align: right; font-size: 1em; color: #53b4ff; font-weight: bold;
        }
        input[type="range"] {
            width: 100%; accent-color: #53b4ff; margin: 0; margin-top: 2px;
        }
        .result-block {
            margin-top: 10px;
            background: #242c36;
            padding: 12px 9px 7px 9px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(70, 118, 250, 0.06);
            font-size: 0.98rem;
            color: #e2e7ed;
        }
        .highlight-result {
            font-size: 1.28em;
            color: #53b4ff;
            font-weight: bold;
            margin: 12px 0 6px 0;
            display: block;
        }
        .footer-brand {
            text-align:center;
            color:#7d95b0;
            font-size: 1em;
            letter-spacing:0.04em;
            margin-top: 10px;
            font-weight: bold;
        }
        select {
            padding: 3px 7px;
            font-size: 0.97em;
            border-radius: 5px;
            border: 1px solid #506380;
            background: #232b33;
            color: #e2e7ed;
        }
        option { background: #232b33; color: #e2e7ed;}
    </style>
</head>
<body>
<div class="calculator">
    <h2>Тепловой поток от бетонной плиты</h2>
    <div class="knob-label">Температура воздуха, °C</div>
    <div class="circle-range-row">
        <button class="circle-range-btn" id="circleMinus" title="Уменьшить">–</button>
        <div class="circle-range-wrapper">
            <svg class="circle-range-svg" width="138" height="138">
                <circle class="circle-range-track" cx="69" cy="69" r="55"/>
                <circle class="circle-range-fill" cx="69" cy="69" r="55" stroke-dasharray="345" stroke-dashoffset="120"/>
                <text x="69" y="65" class="circle-range-text" id="circleTempText">22</text>
                <text x="69" y="99" class="circle-range-label">°C</text>
            </svg>
            <input type="range" min="10" max="40" step="1" value="22" class="circle-range-input" id="circleRange">
        </div>
        <button class="circle-range-btn" id="circlePlus" title="Увеличить">+</button>
    </div>
    <div class="slider-row">
        <div class="slider-label">
            <span>Скорость воздуха, м/с</span>
            <span class="slider-value" id="airSpeedValue">0.00</span>
        </div>
        <input type="range" id="airSpeed" min="0" max="2" step="0.01" value="0">
        <div style="font-size:0.85em;color:#777;margin-top:2px;">
            <span>0: без движения · 0.5: сквозняк · 1.0: вентиляция · 2.0: сильный поток</span>
        </div>
    </div>
    <div class="slider-row">
        <div class="slider-label">
            <span>Температура плиты, °C</span>
            <span class="slider-value" id="tempPlateValue">29</span>
        </div>
        <input type="range" id="tempPlate" min="10" max="40" step="1" value="29">
    </div>
    <div class="slider-row">
        <div class="slider-label">
            <span>Толщина утеплителя, мм</span>
            <span class="slider-value" id="insThickValue">50</span>
        </div>
        <input type="range" id="insThick" min="10" max="300" step="1" value="50">
    </div>
    <div class="slider-row">
        <div class="slider-label">
            <span>λ утеплителя, Вт/(м·К)</span>
            <select id="lambda">
                <option value="0.030">Пенопласт 0.030</option>
                <option value="0.035" selected>Пенополистирол 0.035</option>
                <option value="0.040">Минвата 0.040</option>
                <option value="0.045">Пеностекло 0.045</option>
            </select>
        </div>
    </div>
    <div class="slider-row">
        <div class="slider-label">
            <span>Температура под утеплителем, °C</span>
            <span class="slider-value" id="tBelowValue">0</span>
        </div>
        <input type="range" id="tBelow" min="-30" max="20" step="1" value="0">
    </div>
    <div class="result-block" id="result"></div>
    <div class="footer-brand">Galf Design</div>
</div>
<script>
    // Круглый range для температуры воздуха (с началом вертикально вверх)
    const circleRange = document.getElementById('circleRange');
    const circleTempText = document.getElementById('circleTempText');
    const circleFill = document.querySelector('.circle-range-fill');
    const circleMinus = document.getElementById('circleMinus');
    const circlePlus = document.getElementById('circlePlus');
    const minCircle = 10, maxCircle = 40, circleLen = 2 * Math.PI * 55;

    function updateCircleRange() {
        const value = +circleRange.value;
        const percent = (value - minCircle) / (maxCircle - minCircle);
        const dashoffset = circleLen * (1 - percent);
        circleFill.setAttribute('stroke-dasharray', circleLen);
        circleFill.setAttribute('stroke-dashoffset', dashoffset);
        circleTempText.textContent = value;
        airTemp = value;
        updateResult();
    }
    circleRange.addEventListener('input', updateCircleRange);

    // Кнопки + и -
    circleMinus.onclick = function() {
        let v = +circleRange.value;
        if (v > minCircle) {
            circleRange.value = v - 1;
            updateCircleRange();
        }
    };
    circlePlus.onclick = function() {
        let v = +circleRange.value;
        if (v < maxCircle) {
            circleRange.value = v + 1;
            updateCircleRange();
        }
    };

    // Остальной JS-код для калькулятора
    function getHconvAir(speed) {
        if (speed <= 0.05) return 8;
        if (speed <= 0.2)  return 10;
        if (speed <= 0.5)  return 14;
        if (speed <= 1.0)  return 18;
        if (speed <= 2.0)  return 25;
        return 30;
    }
    function updateResult() {
        const tempPlate = parseInt(document.getElementById('tempPlate').value) || 29;
        document.getElementById('tempPlateValue').textContent = tempPlate;

        const airSpeed = parseFloat(document.getElementById('airSpeed').value);
        document.getElementById('airSpeedValue').textContent = airSpeed.toFixed(2);

        const insThick = parseInt(document.getElementById('insThick').value) || 50;
        document.getElementById('insThickValue').textContent = insThick;
        const lambda = parseFloat(document.getElementById('lambda').value) || 0.035;
        const tBelow = parseInt(document.getElementById('tBelow').value) || 0;
        document.getElementById('tBelowValue').textContent = tBelow;

        const tm = tempPlate;
        const tb = airTemp;
        const dt = tm - tb;

        const alpha_i = (dt !== 0)
            ? 5.3 * (Math.pow(273 + tm, 4) - Math.pow(273 + tb, 4)) / (Math.pow(100, 4) * (tm - tb))
            : 0;

        let alpha_k = 0;
        let alpha_k_src = "";
        if (airSpeed <= 0.05) {
            alpha_k = (dt > 0) ? 3.6 * Math.pow(dt, 0.18) : 0;
            alpha_k_src = "по ГОСТ";
        } else {
            alpha_k = getHconvAir(airSpeed);
            alpha_k_src = "по скорости воздуха";
        }

        const q_rad = alpha_i * dt;
        const q_conv = alpha_k * dt;
        const q_up = q_rad + q_conv;

        const R = (insThick / 1000) / lambda;
        let q_down = R > 0 ? (tm - tBelow) / R : 0;

        document.getElementById('result').innerHTML =
            `<b>ΔT (плита-воздух):</b> ${(dt).toFixed(1)} °C<br>` +
            `<b>α<sub>и</sub> (излучение):</b> ${alpha_i.toFixed(2)} Вт/(м²·К)<br>` +
            `<b>α<sub>к</sub> (конвекция):</b> ${alpha_k.toFixed(2)} Вт/(м²·К) <span style=\"color:#999;font-size:0.97em;\">(${alpha_k_src})</span><hr>` +
            `<b>Излучение вверх:</b> ${q_rad.toFixed(1)} Вт/м²<br>` +
            `<b>Конвекция вверх:</b> ${q_conv.toFixed(1)} Вт/м²<br>` +
            `<b>Поток вниз (через утеплитель):</b> ${q_down.toFixed(1)} Вт/м²` +
            `<span class=\"highlight-result\">Итого вверх: ${q_up.toFixed(1)} Вт/м²</span>`;
    }

    document.getElementById('tempPlate').addEventListener('input', updateResult);
    document.getElementById('airSpeed').addEventListener('input', updateResult);
    document.getElementById('insThick').addEventListener('input', updateResult);
    document.getElementById('lambda').addEventListener('change', updateResult);
    document.getElementById('tBelow').addEventListener('input', updateResult);

    // Первичная инициализация:
    let airTemp = +circleRange.value;
    updateCircleRange();
</script>
</body>
</html>
